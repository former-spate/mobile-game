<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Makeup Advisor</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family:'Montserrat',sans-serif;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      min-height:100vh;
      margin:0;
      padding:0;
      background:linear-gradient(135deg,#fceaff,#ffd6f0);
      color:#333;
    }
    h1 {
      margin-top:50px;
      font-weight:600;
      background:linear-gradient(90deg,#ff9de2,#ff69b4,#d16ba5);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      font-size:3em;
      text-align:center;
    }
    #uploadForm {
      background:rgba(255,255,255,0.85);
      padding:30px;
      border-radius:15px;
      box-shadow:0 8px 20px rgba(0,0,0,0.1);
      display:flex;
      flex-direction:column;
      align-items:center;
      margin-top:30px;
      transition:transform 0.3s ease;
    }
    #uploadForm:hover { transform:scale(1.02); }
    input[type="file"] { margin:20px 0; font-size:16px; }
    button {
      background:linear-gradient(90deg,#ff9de2,#ff69b4,#d16ba5);
      color:white;
      border:none;
      padding:12px 25px;
      border-radius:10px;
      font-size:16px;
      cursor:pointer;
      transition:all 0.3s ease;
    }
    button:hover { transform:translateY(-2px); box-shadow:0 5px 15px rgba(0,0,0,0.2); }
    #preview {
      max-width:200px;
      margin-top:15px;
      border-radius:15px;
      display:none;
      box-shadow:0 8px 20px rgba(0,0,0,0.2);
      transition: transform 0.5s ease, opacity 0.5s ease;
    }
    #preview.show { transform:scale(1.05); opacity:1; }
    #preview.pulse { animation: pulse 1s infinite; }
    @keyframes pulse {
      0% { transform: scale(1.05); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1.05); }
    }
    #loading { display:none; margin-top:20px; }
    .spinner { border:4px solid rgba(0,0,0,0.1); width:36px; height:36px; border-radius:50%; border-left-color:#ff69b4; animation:spin 1s linear infinite; margin:0 auto; }
    @keyframes spin { to { transform: rotate(360deg); } }
    #results {
      opacity:0;
      transform:translateY(20px);
      transition:opacity 0.5s ease, transform 0.5s ease;
      margin-top:30px;
      background:linear-gradient(135deg,#ffe6f0,#ffd6f0);
      padding:25px;
      border-radius:15px;
      box-shadow:0 8px 25px rgba(0,0,0,0.15);
      width:340px;
      text-align:center;
    }
    #results.show { opacity:1; transform:translateY(0); }
    #results h3 { margin-top:0; color:#8e3c96; }
    #results p {
      margin:6px 0;
      font-weight:500;
      opacity:0;
      transform:translateY(10px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    #results p.show { opacity:1; transform:translateY(0); }
  </style>
</head>
<body>

<h1>Makeup Advisor</h1>

<form id="uploadForm">
  <input type="file" name="photo" id="photoInput" accept="image/*" required>
  <img id="preview" src="" alt="Photo preview">
  <button type="submit">Get Suggestions</button>
</form>

<div id="loading">
  <div class="spinner"></div>
</div>

<div id="results"></div>

<script>
const form = document.getElementById("uploadForm");
const photoInput = document.getElementById("photoInput");
const preview = document.getElementById("preview");
const resultsDiv = document.getElementById("results");
const loading = document.getElementById("loading");

photoInput.addEventListener("change", () => {
  const file = photoInput.files[0];
  if(file){
    preview.src = URL.createObjectURL(file);
    preview.style.display="block";
    preview.classList.add("show");
  } else {
    preview.style.display="none";
    preview.classList.remove("show");
  }
});

form.addEventListener("submit", async (e)=>{
  e.preventDefault();

  resultsDiv.style.display="none";
  resultsDiv.classList.remove("show");

  loading.style.display="block";
  preview.classList.add("pulse"); // Start pulsing animation

  const formData = new FormData();
  formData.append("photo", photoInput.files[0]);

  try{
    const response = await fetch("/analyze", { method:"POST", body:formData });
    const data = await response.json();

    loading.style.display="none";
    preview.classList.remove("pulse"); // Stop pulsing animation
    resultsDiv.style.display="block";

    if(data.error){
      resultsDiv.innerHTML=`<p style="color:red;">${data.error}</p>`;
      resultsDiv.classList.add("show");
      return;
    }

    resultsDiv.innerHTML = `<h3>Makeup Suggestions:</h3>
      <p><b>Foundation:</b> ${data.foundation}</p>
      <p><b>Lipstick:</b> ${data.lipstick}</p>
      <p><b>Eyeshadow:</b> ${data.eyeshadow}</p>
      <p><b>Blush:</b> ${data.blush}</p>
      <p><b>Highlighter:</b> ${data.highlighter}</p>
      <p><b>Eyebrows:</b> ${data.eyebrows}</p>
      <p><b>Mascara:</b> ${data.mascara}</p>`;

    resultsDiv.classList.add("show");

    // Animate each line separately
    const lines = resultsDiv.querySelectorAll("p");
    lines.forEach((line, i)=>{
      setTimeout(()=>{ line.classList.add("show"); }, i*200);
    });

  }catch(err){
    loading.style.display="none";
    preview.classList.remove("pulse");
    resultsDiv.style.display="block";
    resultsDiv.innerHTML=`<p style="color:red;">Error: ${err.message}</p>`;
    resultsDiv.classList.add("show");
  }
});
</script>

</body>
</html>

